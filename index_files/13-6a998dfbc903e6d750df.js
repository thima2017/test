webpackJsonp([13],{150:function(t,e,o){"use strict";var i=o(0),n=(o.n(i),o(29));e.a={name:"WithEventCompose",constructor:function(){var t=this;this.events=Object(i.mapValues)(this.events,function(e){return"string"!=typeof e?e:e.split("|>").map(i.trim).reduce(function(e,o){if(!t[o])throw new Error("WithEventCompose error: method '"+o+"' do not exist on view '"+t.displayName+"'.");return Object(n.b)(t[o].bind(t),e)},n.c)})}}},1565:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),n=o.n(i),s=o(261),a=o(2571),r=o(21),l=o(2),h=o(12),d=o(14),c=o(463),p=o(435),u=(o.n(p),o(15)),g=(o.n(u),o(670)),v=o(434),m=o(152),f=o(150),w=o(54),C=d.a.shortcuts;e.default=s.a.extend({tplList:l.default.getFromMacro("skfb_front/macros/viewer","hotspots_list"),_hotspotCycleInterval:null,hotspotViews:[],mixins:[f.a,Object(w.a)(".js-scrollable")],events:{'mousedown [data-action="prev-annotation"]':"stopEvent |> prevHotspot",'mousedown [data-action="next-annotation"]':"stopEvent |> nextHotspot",'touchend [data-action="prev-annotation"]':"stopEvent |> prevHotspot",'touchend [data-action="next-annotation"]':"stopEvent |> nextHotspot",'click [data-action="next-annotation"]':"stopEvent",'click [data-action="prev-annotation"]':"stopEvent",'mousedown [data-action="toggle-autopilot"]':"stopEvent |> toggleAutopilot",'touchend [data-action="toggle-autopilot"]':"stopEvent |> toggleAutopilot",'mousedown [data-action="toggle-visibility"]':"stopEvent |> toggleVisibility",'touchend [data-action="toggle-visibility"]':"stopEvent |> toggleVisibility",'mousedown [data-action="toggle-annotation-list"]':"stopEvent |> toggleAnnotationList",'touchend [data-action="toggle-annotation-list"]':"stopEvent |> toggleAnnotationList","touchstart [data-hotspot-target]":"menuTriggerHotspot","click [data-hotspot-target]":"menuTriggerHotspot","mouseover .control-hotspots .label":"revealHotspots","mouseout .control-hotspots .label":"unrevealHotspots","click .more":"showFullscreenTooltip","mousedown .webgl":"trackMousedownTiming"},initialize:function(){s.a.prototype.initialize.apply(this,arguments),this.initialValue=this.$(".hotspot-name").text(),this.initializeShortcuts(),this.previousHotspot=-1,this.currentHotspot=-1,this._hotspots=this.model.get("hotspots"),0===this._hotspots.length&&this.hideAnnotationControls()},initializeShortcuts:function(){this.annotationControlShortcuts=new c.a(C.annotationControl),this.annotationControlShortcuts.on("prevAnnotation",this.prevHotspot.bind(this)),this.annotationControlShortcuts.on("nextAnnotation",this.nextHotspot.bind(this)),this.annotationControlShortcuts.listen()},delegateEvents:function(){s.a.prototype.delegateEvents.apply(this,arguments),this.model.on("change:visible",this.displayAnnotations,this)},undelegateEvents:function(){s.a.prototype.undelegateEvents.apply(this,arguments),this.model.off("change:visible",this.displayAnnotations,this)},stopEvent:function(t){t.preventDefault(),t.stopPropagation()},trackMousedownTiming:function(t){this._mouseDownTime=Date.now(),this._mouseDownPosition=t.pageX},renderControl:function(t){var e=this.$(".hotspot-name");t?(e.text(t.get("name")),e.removeClass("default")):(e.text(this.initialValue),e.addClass("default"))},isVr:function(){return this.viewer.isVR()},toggleAnnotationList:function(t){this.$(".hotspots-list").toggleClass("visible",t)},toggleAutopilot:function(){var t=this.$('[data-action="toggle-autopilot"]'),e=t.hasClass("--stopped");this.triggerHotspotCycle(e)},toggleVisibility:function(){var t=this.model.get("visible");this.toggleAnnotations(!t),h.a.modelViewerAnnotationsToggled(this.viewer._currentModel.get("uid"),!t)},updateHotspotsControls:function(){var t=this.tplList([this._hotspots.toJSON()]);if(this.viewer.$(".hotspot-controls .list").html(t),this._hotspots.length>0&&!this.isVr()){this.showAnnotationControls();var e=!0===this.viewer.proxySettings.get("annotationsVisible");this.toggleAnnotations(e)}else this.hideAnnotationControls(),g.a&&!Object(r.a)().isApp&&this.toggleAnnotations(!1);this.displayAnnotations(null,this.model.get("visible"))},showFullscreenTooltip:function(t){t.preventDefault(),t.stopPropagation();var e=this._hotspots,o=e.at(this.currentHotspot);o&&(this.viewer.subviews.hotspotsOverlay.setModel(o),this.viewer.subviews.hotspotsOverlay.show())},showAnnotations:function(){this.toggleAnnotations(!0)},hideAnnotations:function(){this.toggleAnnotations(!1)},toggleAnnotations:function(t){this.model.get("visible")!==t&&this.model.set("visible",t)},displayAnnotations:function(t,e){this.$('[data-action="toggle-visibility"]').toggleClass("--hide",e),this.viewer.$el.toggleClass("annotations-enabled",e)},showAnnotationControls:function(){this.viewer.$el.addClass("has-hotspots")},hideAnnotationControls:function(){this.viewer.$el.removeClass("has-hotspots")},hideTooltips:function(){this.hotspotViews.forEach(function(t){t.hideTooltip()})},createHotspotView:function(t){var e=!(!this.viewer.scene||!this.viewer.scene.getOptions().widgetAPI),o=new a.a({viewerModel:this.viewer._currentModel,hotspots:this._hotspots,hotspotIndex:t,viewer:this.viewer,editMode:!!e});return o.$el.appendTo(this.options.container),o},refreshHotspots:function(){var t,e,o=this._hotspots.length;for(t=o,e=this.hotspotViews.length;t<e;++t)this.hotspotViews.pop().remove();for(t=this.hotspotViews.length,e=o;t<e;++t)this.hotspotViews.push(this.createHotspotView(t));this.updatePositionCurrentHotspot(),!this._initCanvasHotspot&&this.isVr()&&(this._initCanvasHotspot=!0,this._hotspots.trigger("inserted"))},updatePositionCurrentHotspot:function(){if(-1!==this.currentHotspot){var t=this.hotspotViews[this.currentHotspot],e=this._hotspots.at(this.currentHotspot),o=[0,0,0];m.a.getScreenPositionFromWorldPoint(e.get("lastComputedWorldPosition"),o),v.a.glCoordToCanvas(o[0],o[1],o),t.setCoordinates(o[0],o[1]),t.preparePositionFix(),t.useTranslate(),t.setPosition(),t.updateTooltipDirection()}},menuTriggerHotspot:function(t){this.viewer.proxySettings.set("annotationsVisible",!0);var e=parseInt(t.currentTarget.getAttribute("data-hotspot-target"),10);this._hotspots.trigger("select",this._hotspots.at(e)),h.a.modelViewerAnnotationListClicked(this.viewer._currentModel.get("uid")),t.stopPropagation()},onHotspotSelected:function(t){var e=this._hotspots.indexOf(t);this.currentHotspot!==e&&(this.previousHotspot=this.currentHotspot,this.currentHotspot=e,this.applyCurrentHotspot(),this.updatePositionCurrentHotspot())},emitHotspotFocus:function(t){this.viewer.scene.trigger("annotationFocus",t),this.hotspotFocus=t},emitHotspotBlur:function(t){this.viewer.scene.trigger("annotationBlur",t),this.hotspotFocus=void 0},applyCurrentHotspot:function(){if(this.hotspotViews.forEach(function(t){t.hideTooltip()}),void 0!==this.hotspotFocusTimeoutID&&(window.clearTimeout(this.hotspotFocusTimeoutID),window.clearTimeout(this.hotspotFocusTooltipTimeoutID),this.hotspotFocusTimeoutID=void 0,this.hotspotFocusTooltipTimeoutID=void 0),void 0!==this.hotspotFocus&&this.emitHotspotBlur(this.hotspotFocus),-1===this.currentHotspot)return void this.renderControl(this._hotspots.at(this.previousHotspot));var t=this._hotspots.at(this.currentHotspot),e=this.hotspotViews[this.currentHotspot],o=this.currentHotspot,i=Math.floor(1500);this.hotspotFocusTimeoutID=window.setTimeout(function(){this.hotspotFocusTimeoutID=void 0,this.emitHotspotFocus(o)}.bind(this),i),e.showTooltip(),this.renderControl(t),this.$(".hotspots-list a").removeClass("active"),this.$('.hotspots-list a[data-hotspot-target="'+this.currentHotspot+'"]').addClass("active")},paginateHotspot:function(t){var e;t=parseInt(t,10);var o=-1===this.currentHotspot?-1===this.previousHotspot?-1:this.previousHotspot:this.currentHotspot;e=-1===o?0:t>0?(o+t)%this._hotspots.length:o+t>=0?o+t:o+t+this._hotspots.length,this._hotspots.trigger("select",this._hotspots.at(e))},nextHotspot:function(){h.a.modelViewerNextAnnotationClicked(this.viewer._currentModel.get("uid")),null!==this._hotspotCycleInterval&&this.triggerHotspotCycle(!1),this.paginateHotspot(1)},beginHotspotCycleInterval:function(t){if(null===this._hotspotCycleInterval){this._hotspotCycleIntervalPaused||this.paginateHotspot(0),window.clearTimeout(this._hotspotPausedCycleTimeout);var e=function(){window.clearInterval(this._hotspotCycleInterval),this._hotspotCycleInterval=window.setInterval(function(){this.paginateHotspot(1)}.bind(this),Object(r.a)().annotationCycleDuration)}.bind(this);t?this._hotspotPausedCycleTimeout=setTimeout(e,t):e()}},pauseHotspotCycleInterval:function(t){var e=!!this._hotspotCycleInterval||this._hotspotCycleIntervalPaused;this.stopHotspotCycleInterval(),e&&t&&(this._hotspotPausedCycleTimeout=setTimeout(this.beginHotspotCycleInterval.bind(this),t)),this._hotspotCycleIntervalPaused=e},stopHotspotCycleInterval:function(){window.clearInterval(this._hotspotCycleInterval),this._hotspotCycleInterval=null,this._hotspotCyclePaused=!1,this._hotspotCycleIntervalPaused=!1,this._hotspotPausedCycleTimeout&&window.clearTimeout(this._hotspotPausedCycleTimeout)},triggerHotspotCycle:function(t){h.a.modelViewerAnnotationsCycleToggled(this.viewer._currentModel.get("uid"),t),this.$('[data-action="toggle-autopilot"]').toggleClass("--stopped",!t),t?(this.beginHotspotCycleInterval(),this.$(".hotspots-list").removeClass("visible")):this.stopHotspotCycleInterval()},prevHotspot:function(){h.a.modelViewerPreviousAnnotationClicked(this.viewer._currentModel.get("uid")),null!==this._hotspotCycleInterval&&this.triggerHotspotCycle(!1),this.paginateHotspot(-1)},replaceImgByUrl:function(t){t.find(".lazyload").each(function(){var t=n()(this).attr("data-uri")||"";t.length>30&&(t=t.substr(0,30)+"..."),n()(this).after("<span>"+t+"</span>"),n()(this).remove()})},revealHotspots:function(){this.viewer.$el.addClass("annotations-peak")},unrevealHotspots:function(){this.viewer.$el.removeClass("annotations-peak")}})},2571:function(t,e,o){"use strict";var i=o(0),n=(o.n(i),o(3)),s=o(7),a=o(2),r=o(12),l=o(206),h=o(295),d=o(1),c=o(15),p=(o.n(c),s.a.extend({mixins:[h.a,l.a],optionTypes:{viewerModel:d.b.model.isRequired,hotspots:d.b.collection.isRequired,hotspotIndex:d.b.number.isRequired,viewer:d.b.object.isRequired,editMode:d.b.bool},macro:["skfb_front/macros/model","model_hotspot"],urlize:a.default.getFromString('{{ content | striptags | urlize(target="_blank") | paragraphy }}'),events:{"click .submit":"inputTitleDescription","change .description":"changeDescription","keydown textarea":"handleTextareaKeys","keydown .title":"handleTitleKeys","click .activate-render":"showRenderedContent","mouseover .activate-render":"renderMarkdown","click .activate-edition":"showEditingContent"},el:function(){return a.default.getFromMacro(this.macro,[n.a.me().toJSON(),this.options])},initialize:function(){s.a.prototype.initialize.apply(this,arguments),this.initializeMarkdown({input:this.$(".edition textarea"),target:this.$(".markdown-rendered-content")}),this.useTopLeft(),this.link()},delegateEvents:function(){s.a.prototype.delegateEvents.apply(this,arguments),this.options.hotspots.on("add remove reset sort",this.link,this)},undelegateEvents:function(){s.a.prototype.undelegateEvents.apply(this,arguments),this.options.hotspots.off("add remove reset sort",this.link,this)},link:function(){this.model&&this.model.off("change",this.render,this),this.model=this.options.model=this.options.hotspots.at(this.options.hotspotIndex),this.model&&this.model.on("change",this.render,this),this.render()},render:function(){if(this.model){var t=function(t){return t!==document.activeElement},e=this.model.get("name"),o=this.model.get("content");this.$(".edition .title").filter(t).text(e).val(e),this.$(".edition .description").filter(t).text(o.raw).val(o.raw),this.$(".title").filter(t).html(this.urlize({content:e}));var n=""!==Object(i.trim)(o.rendered);this.$(".more").toggle(n),this.$(".description").filter(t).html(o.rendered),this.options.viewer.scene.getFeatures().webVR.getModel().get("enable")||this.handleLazyLoading(),this.$(".description")[0]!==document.activeElement&&(this.options.editMode||this.$(".tooltip").toggleClass("no-description",!o.raw))}},showEditingContent:function(){this.$(".meta .selected").removeClass("selected"),this.$(".meta .activate-edition").addClass("selected"),this.$(".render").hide(),this.$(".edition").show()},showRenderedContent:function(){this.renderMarkdown();var t=this.$(".edition .title").val();this.$(".render .title").text(t),this.$(".render").show(),this.$(".edition").hide(),this.$(".meta .selected").removeClass("selected"),this.$(".meta .activate-render").addClass("selected"),this.handleLazyLoading()},inputTitleDescription:function(t){this.$(".edition .title").val()&&(this.renderMarkdown().then(function(t){this.model.set({name:this.$(".edition .title").val(),content:{raw:this.$(".edition .description").val(),rendered:t}})}.bind(this)),this.options.viewer.blurHotspots(),t.stopPropagation(),r.a.annotationEditorTooltipEdited(this.options.viewerModel.get("uid")))},handleTitleKeys:function(t){13===t.keyCode&&this.$(".submit").click()},handleTextareaKeys:function(t){this.unsetMarkdownReady(),13===t.keyCode&&(t.metaKey||t.ctrlKey)&&this.$(".submit").click()},changeDescription:function(){this.options.editMode||this.$(".tooltip").toggleClass("no-description",!this.model.get("description"))},showTooltip:function(){if(this.$el.addClass("selected"),this.$(".tooltip").addClass("visible"),this.updateTooltipDirection(),this.options.editMode){var t=function(){this.x&&this.y&&this.$(".edition .title").focus()}.bind(this);Object(i.defer)(function(){this.tooltipInViewport()?t():setTimeout(t,1200)}.bind(this))}},hideTooltip:function(){this.$el.removeClass("selected"),this.$(".tooltip").removeClass("visible")},updateTooltipDirection:function(){var t=this.el.parentNode.parentNode,e=this.el.querySelector(".tooltip");if(t&&e&&e.classList.contains("visible")){e.classList.remove("reverse-x"),e.classList.remove("reverse-y");var o=e.getBoundingClientRect().left,i=e.getBoundingClientRect().top,n=t.getBoundingClientRect(),s=e.getBoundingClientRect();e.classList.toggle("reverse-x",o+s.width+10>=n.width),e.classList.toggle("reverse-y",i+s.height+10>=n.height)}},setCoordinates:function(t,e){this.x=t,this.y=e},tooltipInViewport:function(){var t=this.$el.closest(".webgl")[0].getBoundingClientRect(),e=this.$(".tooltip")[0].getBoundingClientRect(),o=e.left-t.left>0&&e.left+e.width<t.left+t.width,i=e.top-t.top>0&&e.top+e.height<t.top+t.height;return o&&i},useTranslate:function(){if("translate"!==this.mode&&(this.mode="translate",this.el.parentNode.getBoundingClientRect)){var t=this.el.parentNode.getBoundingClientRect(),e=this.el.getBoundingClientRect(),o=e.left-t.left+e.width/2,i=e.top-t.top+e.height/2;this.$el.css("transform","translate3d("+o+"px,"+i+"px, 0)"),this.$el.css("left","0"),this.$el.css("top","0")}},useTopLeft:function(){if("topleft"!==this.mode&&(this.mode="topleft",this.el.parentNode.getBoundingClientRect)){var t=this.el.parentNode.getBoundingClientRect(),e=this.el.getBoundingClientRect(),o=e.left-t.left+e.width/2,i=e.top-t.top+e.height/2;this.$el.css("transform","none"),this.$el.css("left",o),this.$el.css("top",i)}},setPosition:function(){switch(this.mode){case"translate":this.$el.css("transform","translate3d("+this.x+"px,"+this.y+"px, 0)");break;case"topleft":this.el.style.left=this.x+"px",this.el.style.top=this.y+"px"}},preparePositionFix:function(){var t=this.transformFixTimer=window.requestAnimationFrame(function(){this.transformFixTimer===t&&(this.useTopLeft(),this.setPosition(Math.round(this.x),Math.round(this.y)))}.bind(this))}}));e.a=p},295:function(t,e,o){"use strict";var i=o(109),n=o.n(i),s=o(0),a=(o.n(s),o(4)),r=o.n(a),l=o(5),h=o.n(l),d=o(296),c=o(18);e.a={name:"Markdown",dependencies:["LazyLoading"],initializeMarkdown:function(t){this.options.markdown=Object(s.extend)({},this.options.markdown,t),this.__markdown={ready:!1,loading:!1,promise:null,shortcuts:{}},this.options.markdown.editor&&this.initializeEditor()},initializeEditor:function(){var t=this,e=r()(this.options.markdown.input),i=Object(s.isObject)(this.options.markdown.editor)?this.options.markdown.editor:{};e.addClass("loading-editor"),h.a.all([o.e(9).then(o.bind(null,399)),o.e(7).then(o.bind(null,580)),o.e(8).then(o.bind(null,581))]).then(function(o){var s=n()(o,1),a=s[0],l=a.fromTextArea(e[0],{mode:"gfm",theme:"neo",highlightFormatting:!0,lineWrapping:!0,extraKeys:d.a.getShortcuts()});d.a.setEditor(l),d.a.initializeToolbar(i),i.container&&r()(i.container).addClass("wysiwyg"),e.removeClass("loading-editor"),l.on("beforeChange",function(e,o){t.getMarkdownEditorValue().length+o.text[0].length>parseInt(r()(e.getTextArea()).attr("maxlength"),10)&&"+delete"!==o.origin&&o.cancel()}),l.on("change",function(t){var e=r()(t.getTextArea());e.val(t.getValue()),e.trigger("input")})})},renderMarkdown:function(){var t=this;return this.__markdown.ready?h.a.resolve(this.options.markdown.target[0].innerHTML):this.__markdown.loading?this.__markdown.promise:(this.__markdown.loading=!0,this.__markdown.promise=new h.a(function(e){var o=t.getMarkdownEditorValue();o?(t.unsetMarkdownReady(),c.a.getMarkdownPreview(o).then(function(t){this.setMarkdownReady(t.result),this.handleLazyLoading(),e(t.result)}.bind(t),function(){this.setMarkdownReady("Failed to load preview"),e("")}.bind(t))):(t.setMarkdownReady(""),e(""))}),this.__markdown.promise)},setMarkdownReady:function(t){this.__markdown.ready=!0,this.__markdown.loading=!1,this.options.markdown.target.html(r()("<div></div>").append(t))},unsetMarkdownReady:function(){this.__markdown.ready=!1,this.options.markdown.target.html(r()("<div>Loading preview...</div>"))},getMarkdownEditorValue:function(){return d.a.getMarkdownEditorValue()||this.options.markdown.input?r()(this.options.markdown.input).val():""}}},296:function(t,e,o){"use strict";for(var i=o(4),n=o.n(i),s=function(t){return'<div class="editor-toolbar">'+t+"</div>"},a=[{action:"toggleBold",shortcut:"Cmd-B",title:"Bold",icon:"fa-bold"},{action:"toggleItalic",shortcut:"Cmd-I",title:"Italic",icon:"fa-italic"},{action:"drawLink",shortcut:"Cmd-K",title:"Link",icon:"fa-link"},{action:"toggleHeading",shortcut:"Cmd-H",title:"Heading",icon:"fa-header"},{action:"drawImage",shortcut:"Cmd-Alt-I",title:"Insert Image",icon:"fa-picture-o"},{action:"toggleBlockquote",shortcut:"Cmd-'",title:"Quote",icon:"fa-quote-left"},{action:"toggleOrderedList",shortcut:"Cmd-Alt-L",title:"Numbered List",icon:"fa-list-ol"},{action:"toggleUnorderedList",shortcut:"Cmd-L",title:"Generic List",icon:"fa-list-ul"}],r={bold:"**",code:"```",italic:"*",quote:"> ","unordered-list":"* ","ordered-list":"1. "},l={link:["[","](#url#)"],image:["![","](#url#)"]},h=/Mac/.test(navigator.platform),d=[].concat(a),c="",p={},u={initializeToolbar:function(t){var e=(new DOMParser).parseFromString(s(c),"text/html").body.firstChild;n()(e).on("mousedown","[data-action]",function(t){t.stopImmediatePropagation(),t.preventDefault(),this[t.currentTarget.getAttribute("data-action")]()}.bind(this)),n()(t.container).prepend(e)},getEditor:function(){return this.__editorInstance},setEditor:function(t){this.__editorInstance=t},getShortcuts:function(){return p},getMarkdownEditorValue:function(){var t=this.getEditor();return t?t.getValue():""},toggleBold:function(){this._toggleBlock("bold",r.bold)},toggleItalic:function(){this._toggleBlock("italic",r.italic)},toggleHeading:function(){this._toggleHeading()},toggleBlockquote:function(){this._toggleLine("quote")},toggleOrderedList:function(){this._toggleLine("ordered-list")},toggleUnorderedList:function(){this._toggleLine("unordered-list")},drawLink:function(){var t=this._getCodemirrorState();this._replaceSelection(t.link,l.link,"http://")},drawImage:function(){var t=this._getCodemirrorState();this._replaceSelection(t.image,l.image,"http://")},_getCodemirrorState:function(t){var e=this.getEditor();t=t||e.getCursor("start");var o=e.getTokenAt(t);if(!o.type)return{};for(var i,n,s=o.type.split(" "),a={},r=0;r<s.length;r++)i=s[r],"strong"===i?a.bold=!0:"variable-2"===i?(n=e.getLine(t.line),/^\s*\d+\.\s/.test(n)?a["ordered-list"]=!0:a["unordered-list"]=!0):"atom"===i?a.quote=!0:"em"===i?a.italic=!0:"quote"===i?a.quote=!0:"strikethrough"===i?a.strikethrough=!0:"comment"===i?a.code=!0:"link"===i?a.link=!0:"tag"===i?a.image=!0:i.match(/^header(\-[1-6])?$/)&&(a[i.replace("header","heading")]=!0);return a},_toggleBlock:function(t,e,o){if(!/editor-preview-active/.test(this.getEditor().getWrapperElement().lastChild.className)){o=void 0===o?e:o;var i,n=this.getEditor(),s=this._getCodemirrorState(),a=e,r=o,l=n.getCursor("start"),h=n.getCursor("end");s[t]?(i=n.getLine(l.line),a=i.slice(0,l.ch),r=i.slice(l.ch),"bold"===t?(a=a.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),r=r.replace(/(\*\*|__)/,"")):"italic"===t?(a=a.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),r=r.replace(/(\*|_)/,"")):"strikethrough"===t&&(a=a.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),r=r.replace(/(\*\*|~~)/,"")),n.replaceRange(a+r,{line:l.line,ch:0},{line:l.line,ch:99999999999999}),"bold"===t||"strikethrough"===t?(l.ch-=2,l!==h&&(h.ch-=2)):"italic"===t&&(l.ch-=1,l!==h&&(h.ch-=1))):(i=n.getSelection(),"bold"===t?(i=i.split("**").join(""),i=i.split("__").join("")):"italic"===t?(i=i.split("*").join(""),i=i.split("_").join("")):"strikethrough"===t&&(i=i.split("~~").join("")),n.replaceSelection(a+i+r),l.ch+=e.length,h.ch=l.ch+i.length),n.setSelection(l,h),n.focus()}},_toggleHeading:function(){var t=this.getEditor();if(!/editor-preview-active/.test(t.getWrapperElement().lastChild.className)){for(var e=t.getCursor("start"),o=t.getCursor("end"),i=e.line;i<=o.line;i++)!function(e){var o=t.getLine(e),i=o.search(/[^#]/);o=i<=0?"# "+o:6===i?o.substr(7):"#"+o,t.replaceRange(o,{line:e,ch:0},{line:e,ch:99999999999999})}(i);t.focus()}},_toggleLine:function(t){var e=this.getEditor();if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var o=this._getCodemirrorState(),i=e.getCursor("start"),n=e.getCursor("end"),s={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},a=i.line;a<=n.line;a++)!function(i){var n=e.getLine(i);n=o[t]?n.replace(s[t],"$1"):r[t]+n,e.replaceRange(n,{line:i,ch:0},{line:i,ch:99999999999999})}(a);e.focus()}},_replaceSelection:function(t,e,o){var i=this.getEditor();if(!/editor-preview-active/.test(i.getWrapperElement().lastChild.className)){var n,s=e[0],a=e[1],r=i.getCursor("start"),l=i.getCursor("end");o&&(a=a.replace("#url#",o)),t?(n=i.getLine(r.line),s=n.slice(0,r.ch),a=n.slice(r.ch),i.replaceRange(s+a,{line:r.line,ch:0})):(n=i.getSelection(),i.replaceSelection(s+n+a),r.ch+=s.length,r!==l&&(l.ch+=s.length)),i.setSelection(r,l),i.focus()}},_tabAndIndentMarkdownList:function(t){var e=t.listSelections(),o=e[0].head;if(!1!==t.getStateAfter(o.line).list)return void t.execCommand("indentMore");if(t.options.indentWithTabs)t.execCommand("insertTab");else{var i=Array(t.options.tabSize+1).join(" ");t.replaceSelection(i)}},_shiftTabAndUnindentMarkdownList:function(t){var e=t.listSelections(),o=e[0].head;if(!1!==t.getStateAfter(o.line).list)return void t.execCommand("indentLess");if(t.options.indentWithTabs)t.execCommand("insertTab");else{var i=Array(t.options.tabSize+1).join(" ");t.replaceSelection(i)}}},g=0;g<d.length;g++)d[g].action&&u[d[g].action]&&(c+=function(t){return'<a title="'+t.title+" ("+t.shortcut+')" data-action="'+t.action+'" tabindex="-1" class="fa '+t.icon+'"></a>'}(d[g]),p[function(t){return h?t.replace("Ctrl","Cmd"):t.replace("Cmd","Ctrl")}(d[g].shortcut)]=function(t){return u[t.action]()}.bind(u,d[g]));p.Enter="newlineAndIndentContinueMarkdownList",p.Tab=u._tabAndIndentMarkdownList.bind(u),p["Shift-Tab"]=u._shiftTabAndUnindentMarkdownList.bind(u),e.a=u}});
//# sourceMappingURL=13-6a998dfbc903e6d750df.js.map